<!DOCTYPE html>
<html lang="en">
<script src="/libs/jquery-3.2.1.min.js"></script>
<style>
    html
    {
        overflow: hidden;
    }
    @font-face {
        font-family: myFont;
        src: url('/fonts/MarfaFontlinealregular-663wt_regularTwo.otf');
    }
    iframe
    {
        position: absolute;
        /*min-width: 500px;*/
        /*max-width: 1500px;*/
        width: 100%;
        height: 100%;
        -webkit-transition: -webkit-transform 2s ease-in-out;
        -moz-transition: -moz-transform 2s ease-in-out;
        -o-transition: -o-transform 2s ease-in-out;
        transition: transform 2s ease-in-out;
    }

    .noTransition
    {
        -moz-transition: none;
        -webkit-transition: none;
        -o-transition: none;
        transition: none;
    }


    #imgCross
    {
        vertical-align: top;
        width: 100%; /* max width */
    }

    #homePage
    {
        /*background: #00d4b4;*/
        left: 100%;
        top: 100%;
    }
    #videoUp1
    {
        /*background: #2F6FAD;*/
        left:100%;
        top:0%;
    }
    /*#videoUp2*/
    /*{*/
        /*background: #c09853;*/
        /*left: 150%;*/
        /*top: 0%;*/
    /*}*/
    #videoDown1
    {
        /*background: #b94a48;*/
        left: 100%;
        top: 200%;
    }
    /*#videoDown2*/
    /*{*/
        /*background: blue;*/
        /*left: 150%;*/
        /*top: 300%;*/
    /*}*/
    #documents1
    {
       /*background: aqua;*/
        left: 200%;
        top: 100%;
    }
    /*#documents2*/
    /*{*/
        /*background: blueviolet;*/
        /*left: 300%;*/
        /*top: 150%;*/
    /*}*/
    #dataBase1
    {
        /*background: chartreuse;*/
        left: 0%;
        top: 100%;
    }
    /*#dataBase2*/
    /*{*/
        /*background: darkcyan;*/
        /*left: 0%;*/
        /*top: 150%;*/
    /*}*/
    .arrowImg{
        visibility: hidden;
        opacity: 0;
        transition: all .5s ease;
    }
    .arrow {
        width: 5%;
    }

    .show {
        opacity: 0.75;
        visibility: visible;
    }
</style>

<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
    <iframe style="width: 100vw; height: 100vh; margin: auto; align-content: center;" id="videoUp1" src="videoUp1.html" webkitallowfullscreen mozallowfullscreen allowfullscreen>
    </iframe>
    <!--<iframe id="videoUp2">-->
    <!--</iframe>-->
    <iframe style="width: 100vw; height: 100vh; margin: auto; align-content: center;" id="videoDown1" src="videoDown1.html" webkitallowfullscreen mozallowfullscreen allowfullscreen>
    </iframe>
    <!--<iframe id="videoDown2">-->
    <!--</iframe>-->
    <iframe style="width: 100vw; height: 100vh; margin: auto; align-content: center;" id="documents1" src="videoDocuments1.html" webkitallowfullscreen mozallowfullscreen allowfullscreen>
    </iframe>
    <!--<iframe id="documents2">-->
    <!--</iframe>-->
    <iframe style="width: 100vw; height: 100vh; margin: auto; align-content: center;" id="homePage" src="home.html" webkitallowfullscreen mozallowfullscreen allowfullscreen>
    </iframe>
    <iframe id="dataBase1" src="dataBase1.html">
    </iframe>
    <!--<iframe id="dataBase2">-->
    <!--</iframe>-->

    <div class="arrowImg" id="upArrow"style="width:100vw; position: fixed; top:0; left:0; height: 5vh; background-color: white;">
        <div style="position:inherit; top:0;left: 50vw; height:inherit;">
            <div style="position:inherit; height:inherit; transform: translate(0%, 0%);">
                <div class="arrowImg" id="upTitle"style="position: inherit;font-size: 24px; height: 27px; font-family: myFont;">Dysfordance</div>
                <img style="position: inherit; height: inherit;" src="arrow_black.png">
            </div>
        </div>
    </div>
    <div class="arrowImg" id="downArrow"style="width:100vw; position: fixed; bottom:0; left:0; height: 5vh; background-color: white;">
        <div style="position:inherit; bottom:0;left: 50vw; height:inherit;transform: rotate(180deg);">
            <div style="position:inherit; height:inherit; transform: translate(0%, 0%);">
                <div class="arrowImg" id="downTitle"style="position:inherit;font-size: 24px; height: 27px; font-family: myFont;transform: rotate(180deg);">Dysfordance</div>
                <img style="position:inherit;height: inherit;" src="arrow_black.png">
            </div>
        </div>
    </div>
    <div class="arrowImg" id="leftArrow"style="height:90vh; position: fixed;top:0; left:0; width: 5vw; background-color: white; transform: translate(-50%, 5vh);">
        <div style="position:inherit; left:0;bottom: 50vh; width:inherit;transform: rotate(270deg);">
            <div style="position:inherit; width:inherit; transform: translate(0%, 0%);">
                <div class="arrowImg" id="leftTitle"style="position:inherit; font-size: 24px; height: 27px; white-space: nowrap; font-family: myFont;">Base de donnee</div>
                <img style="position: inherit;width: inherit;" src="arrow_black.png">
            </div>
        </div>
    </div>
    <div class="arrowImg" id="rightArrow"  style="height:90vh; position: fixed;top:0; right:0; width: 5vw; background-color: white; transform: translate(50%, 5vh);">
        <div style="position:inherit; right:0;top: 50vh; width:inherit;transform: rotate(90deg);">
            <div style="position:inherit; width:inherit; transform: translate(-50%, 0%);">
                <div class="arrowImg" id="rightTitle"style="position:inherit;font-size: 24px; height: 27px; font-family: myFont;">Documents</div>
                <img style="position:inherit; width: inherit;" src="arrow_black.png">
            </div>
        </div>
    </div>
    <div id="cross" style="border:2px solid black; position:fixed; bottom: 0;right: 0;width: 29px; height: 29px;">
        <img id="imgCross" src="cross_white.jpg">
    </div>
    <script src="/libs/socket.io.slim.js"></script>
    <script>
        document.onload = document.getElementById("homePage").scrollIntoView(true);
        setInterval(function()
        {
            document.getElementById("homePage").scrollIntoView(true);
        },1000);
        window.addEventListener('resize', function() {
            document.getElementById("homePage").scrollIntoView(true);
        });
        window.addEventListener('fullscreenchange', function() {
            document.getElementById("homePage").scrollIntoView(true);
        });
        var lengthDataBase = 0;
        var timer;
        var timer1;
        var videoUp = ["videoUp1.html"];
        var videoUpIndex = 0;
        var videoDown = ["videoDown1.html"];
        var videoDownIndex = 0;
        var dataBase = ["dataBase1.html", "dataBase2.html"];
        var dataBaseIndex = 0;
        var documents = ["videoDocuments1.html","documents1.html","documents2.html","documents3.html","documents4.html","documents5.html","documents6.html"];
        var documentsIndex = 0;
        var currentSource = "home.html";
        var currentIsVideo = false;
        var socket = io('https://localhost');

        socket.on('reload', function(data){
            if (data)
            {
                location.reload();
            }
        });
        $('#upArrow').mouseover(function(){
           if ($('#upArrow').hasClass('show'))
           {
               $('#upTitle').addClass('show');
           }
        });
        $('#downArrow').mouseover(function(){
            if ($('#downArrow').hasClass('show'))
            {
                $('#downTitle').addClass('show');
            }
        });
        $('#leftArrow').mouseover(function(){
            if ($('#leftArrow').hasClass('show'))
            {
                $('#leftTitle').addClass('show');
            }
        });
        $('#rightArrow').mouseover(function(){
            if ($('#rightArrow').hasClass('show'))
            {
                $('#rightTitle').addClass('show');
            }
        });
        $('#upArrow').mouseout(function(){
            $('#upTitle').removeClass('show');
        });
        $('#downArrow').mouseout(function(){
                $('#downTitle').removeClass('show');
        });
        $('#leftArrow').mouseout(function(){
                $('#leftTitle').removeClass('show');
        });
        $('#rightArrow').mouseout(function(){
                $('#rightTitle').removeClass('show');
        });
        var onMouseMove = function () {
            //console.log("test");
            if (document.getElementById("imgCross").getAttribute('src') === "cross_black.jpg" )
                return;
            if (videoUpIndex < videoUp.length)
                $('#upArrow').addClass('show');
            else
                $('#upArrow').removeClass('show');
            if (videoDownIndex < videoDown.length)
                $('#downArrow').addClass('show');
            else
                $('#downArrow').removeClass('show');
            if (documentsIndex < documents.length)
                $('#rightArrow').addClass('show');
            else
                $('#rightArrow').removeClass('show');
            if (lengthDataBase > 0) {
                $('#leftArrow').addClass('show');
            }
            else
                $('#leftArrow').removeClass('show');
            try {
                clearTimeout(timer);
            } catch (e) {}
            //if (currentIsVideo)
            //    return;
            timer = setTimeout(function () {
                $('.arrowImg').removeClass('show');
            }, 500);
        }
        document.getElementById('dataBase1').onload = function()
        {
            httpGetAsync("/get_range_data_length?range=" + (dataBaseIndex * 48), function(data) {
                lengthDataBase = parseInt(data);
            })
        };
        document.getElementById('homePage').onload = function()
        {
            $('#homePage').css({'visibility': 'visible'});
        };
        $(window).on('mousemove', onMouseMove);

        var swapId = function(id1, id2)
        {
            var doc1 = document.getElementById(id1);
            var doc2 = document.getElementById(id2);
            doc1.id = id2;
            doc2.id = id1;
        };
        var bubbleIframeMouseMove = function( iframe ){

            iframe.contentWindow.addEventListener('mousemove', function( event ) {
                var boundingClientRect = iframe.getBoundingClientRect();

                var evt = new CustomEvent( 'mousemove', {bubbles: true, cancelable: false})
                evt.clientX = event.clientX + boundingClientRect.left;
                evt.clientY = event.clientY + boundingClientRect.top;

                iframe.dispatchEvent( evt );

            });

        };
        function httpGetAsync(theUrl, callback)
        {
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function() {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                    callback(xmlHttp.responseText);
            }
            xmlHttp.open("GET", theUrl, true); // true for asynchronous
            xmlHttp.send(null);
        }
        var translateElementX = function(id1, id2, direction, array, index, isDataBase, isVideo)
        {
            var element1 = $('#'+ id1);
            var element2 = $('#'+ id2);
            if (isVideo)
                element2.css({"background-color":"black"});
            else
                element2.css({"background-color":"white"});
            if (element1[0].plyr)
                element1[0].plyr.pause();
            element1.css({"-webkit-transform":"translate(" + 100 * direction + "vw, 0vh)"});
            element2.css({"-webkit-transform":"translate(" + 100 * direction + "vw, 0vh)"});
            element1.css({"-moz-transform":"translate(" + 100 * direction + "vw, 0vh)"});
            element2.css({"-moz-transform":"translate(" + 100 * direction + "vw, 0vh)"});
            element1.css({"-o-transform":"translate(" + 100 * direction + "vw, 0vh)"});
            element2.css({"-o-transform":"translate(" + 100 * direction + "vw, 0vh)"});
            element1.css({"transform":"translate(" + 100 * direction + "vw, 0vh)"});
            element2.css({"transform":"translate(" + 100 * direction + "vw, 0vh)"});
            setTimeout(function()
            {
                //element1.css({'visibility': 'hidden'});
                setTimeout(function(){

                    //element1[0].src = element2[0].src;

                    swapId(id1, id2);
                    var elementId1 = document.getElementById(id1);
                    var elementId2 = document.getElementById(id2);
                    elementId1.style.left = "100vw";
                    elementId1.style.top = "100vh";
                    elementId2.style.top = "100vh";
                    if (id2 == "documents1")
                        elementId2.style.left = "200vw";
                    else
                        elementId2.style.left = "0vw";
                    element1.addClass('noTransition');
                    element2.addClass('noTransition');
                    element1.css({"-webkit-transform":"translate(0vw, 0vh)"});
                    element2.css({"-webkit-transform":"translate(0vw, 0vh)"});
                    element1.css({"-moz-transform":"translate(0vw, 0vh)"});
                    element2.css({"-moz-transform":"translate(0vw, 0vh)"});
                    element1.css({"-o-transform":"translate(0vw, 0vh)"});
                    element2.css({"-o-transform":"translate(0vw, 0vh)"});
                    element1.css({"transform":"translate(0vw, 0vh)"});
                    element2.css({"transform":"translate(0vw, 0vh)"});
                    if (isDataBase)
                    {
                        elementId2.src = array[index % 2];
                    }
                    else
                    {
                        if (array[index])
                            elementId2.src = array[index];
                        else
                            elementId2.src = "nothingMore.html";
                    }
                    setTimeout(function(){
                        element1.removeClass('noTransition');
                        element2.removeClass('noTransition');
                        currentIsVideo = isVideo;
                        bubbleIframeMouseMove( document.getElementById('homePage'));
                      //  if (isVideo) {
                        //    onMouseMove();
                        //}
                    }, 200);
                }, 50);
            }, 1950);
        }

        var translateElementY = function(id1, id2, direction, array, index, isVideo)
        {
            var element1 = $('#'+ id1);
            var element2 = $('#'+ id2);
            if (isVideo)
                element2.css({"background-color":"black"});
            else
                element2.css({"background-color":"white"});
            if (element1[0].plyr)
                element1[0].plyr.pause();
            element1.css({"-webkit-transform":"translate(0vw, " + 100 * direction + "vh)"});
            element2.css({"-webkit-transform":"translate(0vw, " + 100 * direction + "vh)"});
            element1.css({"-moz-transform":"translate(0vw, " + 100 * direction + "vh)"});
            element2.css({"-moz-transform":"translate(0vw, " + 100 * direction + "vh)"});
            element1.css({"-o-transform":"translate(0vw, " + 100 * direction + "vh)"});
            element2.css({"-o-transform":"translate(0vw, " + 100 * direction + "vh)"});
            element1.css({"transform":"translate(0vw, " + 100 * direction + "vh)"});
            element2.css({"transform":"translate(0vw, " + 100 * direction + "vh)"});
            setTimeout(function()
            {
                //element1.css({'visibility': 'hidden'});
                setTimeout(function(){
                    swapId(id1, id2);
                    var elementId1 = document.getElementById(id1);
                    var elementId2 = document.getElementById(id2);
                    elementId1.style.top = "100vh";
                    elementId1.style.left = "100vw";
                    elementId2.style.left = "100vw";
                    if (id2 == "videoDown1s")
                        elementId2.style.top = "200vw";
                    else
                        elementId2.style.top = "0vw";
                    element1.addClass('noTransition');
                    element2.addClass('noTransition');
                    element1.css({"-webkit-transform":"translate(0vw, 0vh)"});
                    element2.css({"-webkit-transform":"translate(0vw, 0vh)"});
                    element1.css({"-moz-transform":"translate(0vw, 0vh)"});
                    element2.css({"-moz-transform":"translate(0vw, 0vh)"});
                    element1.css({"-o-transform":"translate(0vw, 0vh)"});
                    element2.css({"-o-transform":"translate(0vw, 0vh)"});
                    element1.css({"transform":"translate(0vw, 0vh)"});
                    element2.css({"transform":"translate(0vw, 0vh)"});
                    if (index < array.length)
                        elementId2.src = array[index];
                    else
                        elementId2.src = "nothingMore.html";
                    setTimeout(function(){
                        element1.removeClass('noTransition');
                        element2.removeClass('noTransition');
                        currentIsVideo = isVideo;
                        bubbleIframeMouseMove(document.getElementById('homePage'));
                    }, 200);
                }, 50);
            }, 1950);
        }
        bubbleIframeMouseMove(document.getElementById('homePage'));
//        bubbleIframeMouseMove(document.getElementById('videoUp1'));
////        bubbleIframeMouseMove($('#videoUp2')[0]);
//        bubbleIframeMouseMove(document.getElementById('videoDown1'));
////        bubbleIframeMouseMove($('#videoDown2')[0]);
//        bubbleIframeMouseMove(document.getElementById('documents1'));
////        bubbleIframeMouseMove($('#documents2')[0]);
//        bubbleIframeMouseMove(document.getElementById('dataBase1'));
////        bubbleIframeMouseMove($('#dataBase2')[0]);
        document.getElementById("cross").onmouseup = function()
        {
            var img = document.getElementById("imgCross");
            if(img.getAttribute('src') === "cross_white.jpg")
            {
                img.src = "cross_black.jpg";
                var iframe = document.getElementById("homePage");
                currentSource = iframe.src;
                $("#homePage").css({"background-color":"white"});
                iframe.src = "details.html";
                $('.arrowImg').removeClass('show');
            }
            else
            {
                var iframe = document.getElementById("homePage");
                if (currentIsVideo)
                    $("#homePage").css({"background-color":"black"});
                iframe.src = currentSource;
                img.src = "cross_white.jpg";
                iframe.onload = function() {
                    bubbleIframeMouseMove(iframe);
                };
            }
        };
        document.onkeyup = function()
        {
            if (document.getElementById("imgCross").getAttribute('src') === "cross_black.jpg")
                return;
            if (event.keyCode == 38 && videoUp[videoUpIndex]) {
                videoUpIndex++;
                videoDownIndex = 0;
                dataBaseIndex = 0;
                documentsIndex = 0;
                localStorage.setItem("range1", 0);
                document.getElementById('videoDown1').src = videoDown[videoDownIndex];
                document.getElementById('dataBase1').src = dataBase[dataBaseIndex];
                document.getElementById('documents1').src = documents[documentsIndex];
                translateElementY('homePage', 'videoUp1', 1, videoUp, videoUpIndex, videoUp[videoUpIndex - 1].indexOf("video") !== -1);
            }
            else if (event.keyCode == 40 && videoDown[videoDownIndex]) {
                videoDownIndex++;
                videoUpIndex = 0;
                dataBaseIndex = 0;
                documentsIndex = 0;
                localStorage.setItem("range1", 0);
                document.getElementById('videoUp1').src = videoUp[videoUpIndex];
                document.getElementById('dataBase1').src = dataBase[dataBaseIndex];
                document.getElementById('documents1').src = documents[documentsIndex];
                translateElementY('homePage', 'videoDown1', -1, videoDown, videoDownIndex, videoDown[videoDownIndex - 1].indexOf("video") !== -1);
            }
            else if (event.keyCode == 37 && lengthDataBase > 0)
            {
                dataBaseIndex++;
                videoUpIndex = 0;
                videoDownIndex = 0;
                documentsIndex = 0;
                document.getElementById('videoUp1').src = videoUp[videoUpIndex];
                document.getElementById('videoDown1').src = videoDown[videoDownIndex];
                document.getElementById('documents1').src = documents[documentsIndex];
                if (dataBaseIndex % 2 == 0)
                    localStorage.setItem("range1", dataBaseIndex * 48);
                else
                    localStorage.setItem("range2", dataBaseIndex * 48);
                translateElementX('homePage', 'dataBase1', 1, dataBase, dataBaseIndex, true, false);
            }
            else if (event.keyCode == 39 && documents[documentsIndex]) {
                documentsIndex++;
                videoUpIndex = 0;
                videoDownIndex = 0;
                dataBaseIndex = 0;
                localStorage.setItem("range1", 0);
                document.getElementById('videoUp1').src = videoUp[videoUpIndex];
                document.getElementById('videoDown1').src = videoDown[videoDownIndex];
                document.getElementById('dataBase1').src = dataBase[dataBaseIndex];
                translateElementX('homePage', 'documents1', -1, documents, documentsIndex, false, documents[documentsIndex - 1].indexOf("video") !== -1);
            }

        };
        document.getElementById("upArrow").onmouseup = function()
        {
            if (document.getElementById("imgCross").getAttribute('src') === "cross_black.jpg")
                return;
            if (videoUp[videoUpIndex]) {
                videoUpIndex++;
                videoDownIndex = 0;
                dataBaseIndex = 0;
                documentsIndex = 0;
                localStorage.setItem("range1", 0);
                document.getElementById('videoDown1').src = videoDown[videoDownIndex];
                document.getElementById('dataBase1').src = dataBase[dataBaseIndex];
                document.getElementById('documents1').src = documents[documentsIndex];
                translateElementY('homePage', 'videoUp1', 1, videoUp, videoUpIndex, videoUp[videoUpIndex - 1].indexOf("video") !== -1);
            }
        }
        document.getElementById("downArrow").onmouseup = function()
        {
            if (document.getElementById("imgCross").getAttribute('src') === "cross_black.jpg")
                return;
            if (videoDown[videoDownIndex]) {
                videoDownIndex++;
                videoUpIndex = 0;
                dataBaseIndex = 0;
                documentsIndex = 0;
                localStorage.setItem("range1", 0);
                document.getElementById('videoUp1').src = videoUp[videoUpIndex];
                document.getElementById('dataBase1').src = dataBase[dataBaseIndex];
                document.getElementById('documents1').src = documents[documentsIndex];
                translateElementY('homePage', 'videoDown1', -1, videoDown, videoDownIndex, videoDown[videoDownIndex - 1].indexOf("video") !== -1);
            }
        }
        document.getElementById("leftArrow").onmouseup = function()
        {
            if (document.getElementById("imgCross").getAttribute('src') === "cross_black.jpg")
                return;
                if (lengthDataBase > 0)
                {
                    dataBaseIndex++;
                    videoUpIndex = 0;
                    videoDownIndex = 0;
                    documentsIndex = 0;
                    document.getElementById('videoUp1').src = videoUp[videoUpIndex];
                    document.getElementById('videoDown1').src = videoDown[videoDownIndex];
                    document.getElementById('documents1').src = documents[documentsIndex];
                    if (dataBaseIndex % 2 == 0)
                        localStorage.setItem("range1", dataBaseIndex * 48);
                    else
                        localStorage.setItem("range2", dataBaseIndex * 48);
                    translateElementX('homePage', 'dataBase1', 1, dataBase, dataBaseIndex, true, false);
                }
        }
        document.getElementById("rightArrow").onmouseup = function()
        {
            if (document.getElementById("imgCross").getAttribute('src') === "cross_black.jpg")
                return;
            if (documents[documentsIndex]) {
                documentsIndex++;
                videoUpIndex = 0;
                videoDownIndex = 0;
                dataBaseIndex = 0;
                localStorage.setItem("range1", 0);
                document.getElementById('videoUp1').src = videoUp[videoUpIndex];
                document.getElementById('videoDown1').src = videoDown[videoDownIndex];
                document.getElementById('dataBase1').src = dataBase[dataBaseIndex];
                translateElementX('homePage', 'documents1', -1, documents, documentsIndex, false, documents[documentsIndex - 1].indexOf("video") !== -1);
            }
        }
    </script>
</body>
</html>